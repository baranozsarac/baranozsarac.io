<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<title>Automation Hub Idea Sayacı</title>
<style>
  body { font-family: Arial, sans-serif; padding: 2rem; text-align: center; background:#f5f7fa; color:#333; }
  h1 { font-size: 2rem; margin-bottom: .5rem; }
  #count { font-size: 4rem; font-weight: bold; margin: 1rem 0; }
  button { padding: .5rem 1rem; font-size: 1rem; border: none; border-radius: 8px; cursor: pointer; background: #0066ff; color: #fff; }
  button:hover { opacity: 0.9; }
</style>
</head>
<body>
  <h1>Automation Hub'daki Toplam Fikir Sayısı</h1>
  <div id="count">...</div>
  <button id="refresh">Yenile</button>

  <script>
  /*
   * Basit tek sayfa uygulaması:
   * Automation Hub API'dan tüm fikir (Idea) sayısını çeker ve gösterir.
   * 1. Aşağıdaki üç sabiti kendi ortamınıza göre doldurun.
   * 2. Sayfayı GitHub Pages ya da benzeri bir yerde barındırın.
   * 3. Sayfa yüklendiğinde ve Yenile butonuna basıldığında sayı güncellenir.
   */

  const ORG_NAME = "pumanhharwvq";        // Örn: acme
  const TENANT_NAME = "Global";  // Örn: default
  const AUTH_TOKEN = "0d5c7235-8fa1-41a3-9342-46dcc40cb94f/042545da-950d-44d3-9209-19069ac92be7"; // Bearer için tüm string

  async function fetchIdeasCount() {
    const url = `https://cloud.uipath.com/${ORG_NAME}/${TENANT_NAME}/automationhub_/api/v1/openapi/automations?page=1&pageSize=1`;

    try {
      const res = await fetch(url, {
        method: "GET",
        headers: {
          "Content-Type": "application/json",
          "Authorization": `Bearer ${AUTH_TOKEN}`,
          "x-ah-openapi-auth": "openapi-token"
          // Eğer App Key tanımlıysa ekleyin:
          // "x-ah-openapi-app-key": "<app_key>"
        }
      });

      if (!res.ok) {
        throw new Error(`HTTP ${res.status}`);
      }

      const data = await res.json();
      document.getElementById("count").textContent =
        data?.data?.totalItems ?? "0";
    } catch (err) {
      console.error(err);
      document.getElementById("count").textContent = "Hata!";
    }
  }

  document.addEventListener("DOMContentLoaded", fetchIdeasCount);
  document.getElementById("refresh").addEventListener("click", fetchIdeasCount);
  </script>
</body>
</html>
